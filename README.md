## Mobile security checklist

This requirement guide is based on OWASP recommendations on mobile security.

#### Data storage on device
- [ ] System credential storage facilities need to be used to store sensitive data, such as PII, user credentials or cryptographic keys.
- [ ] No sensitive data should be stored outside of the app container or system credential storage facilities.
- [ ] When possible, no sensitive data should be stored locally on the mobile device. Instead, data should be retrieved from a remote endpoint when needed and only be kept in memory. (ex: get users permission with his jwt at each http request call instead of storing it on the device since his permissions may change anytime)
- [ ] If sensitive data is still required to be stored locally, it should be encrypted using a key derived from hardware backed storage (such as KeyStore) which requires authentication.
- [ ] The app’s local storage should be wiped after an excessive number of failed authentication attempts.
- [ ] The app does not hold sensitive data in memory longer than necessary, and memory is cleared explicitly after use.
- [ ] No sensitive data should be written to application logs.
- [ ] No sensitive data is included in backups generated by the mobile operating system.
- [ ] Ensure data validation (for content and signature with cryptographic controls such as HMAC to ensure data correctness) and sanitization when reading from the storage
- [ ] Sensible data should not be stored in public shared preferences storage, it needs to be encrypted first.
- [ ] Sensible data should not be stored in unencrypted database (SQLite, Realm, ...) storage
- [ ] Sensible data should not be stored in internal or external storage.

#### Data storage on device (References)
- [ ] Secure data storage on Android reference: https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05d-Testing-Data-Storage.md
- [ ] Secure data storage on Android reference: https://developer.android.com/training/articles/keystore
- [ ] Secure data storage on Android reference: https://developer.android.com/topic/security/data
- [ ] Secure data storage on Android reference: https://developer.android.com/training/articles/security-key-attestation
- [ ] Possible implementation solution (POC): https://medium.com/@ericfu/securely-storing-secrets-in-an-android-application-501f030ae5a3
- [ ] Secure data storage on IOS reference: https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06d-Testing-Data-Storage.md
- [ ] Secure data storage on IOS reference: https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06d-testing-data-storage#checking-logs-for-sensitive-data-mstg-storage-3


#### Sensitive data in logs
- [ ] Never log sensible data.
- [ ] Use tools like ProGuard to remove all logging-related code in production release.

#### Sensitive data in 3rd parties
- [ ] Only allow necessary/minimum permissions in AndroidManifest.xml for any 3rd parties (jar, api calls, sdk)
- [ ] Check used source code from 3rd parties (jar, api calls, sdk)
- [ ] Check if 3rd parties are actively releasing new versions
- [ ] Keep dependencies up to date at all time

#### Sensitive data in IPC
- [ ] Properly configure IPC to not leak sensitive data that content providers may allow app’s stored data to be accessed and modified by other apps.
- [ ] Identified by <provider> tag inside the AndroidManifest.xml
- [ ] android:exported should be explicitly set to “false” if the content is
meant to be accessible only by the app itself, otherwise define proper
read/write permissions inside the AndroidManifest.xml
- [ ] android:permission tags must be used to limit exposure to others inside the AndroidManifest.xml
- [ ] android:protectionLevel should be set to “signature” (content accessible only by apps signed with the same key) inside the AndroidManifest.xml

#### Sensible data in views
- [ ] Explicitly disabled screenshots in the activities/pages/layouts that shows sensitive data by setting a FLAG_SECURE to the layout.
- [ ] The app removes sensitive data from views when moved to the background.



#### Cryptographic API
- [ ] Do not create your own cryptographic algorithm
- [ ] Verify that the configuration of cryptographic algorithms used are aligned with best practices from NIST and BSI
- [ ] Do not use insecure java.util.Random for sensible data


#### Enforce secure communication
- [ ] Use SSL trafic everywhere
- [ ] Use implicit intents and non-exported content providers 
- [ ] Show an app chooser to allow user sto transfer sensible information only to trusted apps.
- [ ] Apply signature-based permissions
- [ ] Disallow access to your app's content providers if there are no intents to send data to other apps
- [ ] Ask for credentials before showing sensitive information
- [ ] Implement a network security configuration to configure trusted CA
